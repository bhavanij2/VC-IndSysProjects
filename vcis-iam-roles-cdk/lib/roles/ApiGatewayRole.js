"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const aws_iam_1 = require("@aws-cdk/aws-iam");
const Resources_1 = require("../model/Resources");
const LambdaInvokePolicy_1 = require("../policies/lambda/LambdaInvokePolicy");
const KinesisProduceMessagePolicy_1 = require("../policies/kinesis/KinesisProduceMessagePolicy");
const CloudWatchBasicLoggingPolicy_1 = require("../policies/cloud-watch/CloudWatchBasicLoggingPolicy");
const SqsProduceMessagePolicy_1 = require("../policies/sqs/SqsProduceMessagePolicy");
const ServicePrincipals_1 = require("./ServicePrincipals");
const vcis_cdk_utils_1 = require("@monsantoit/vcis-cdk-utils");
class ApiGatewayRole {
    static create(stack) {
        const role = new aws_iam_1.Role(stack, Resources_1.Resources.API_GW_ROLE, {
            assumedBy: new aws_iam_1.ServicePrincipal(ServicePrincipals_1.ServicePrincipals.API_GW),
            roleName: vcis_cdk_utils_1.NamingConvention.apply(Resources_1.Resources.API_GW_ROLE)
        });
        role.attachInlinePolicy(LambdaInvokePolicy_1.LambdaInvokePolicy.get(stack));
        role.attachInlinePolicy(KinesisProduceMessagePolicy_1.KinesisProduceMessagePolicy.get(stack));
        role.attachInlinePolicy(CloudWatchBasicLoggingPolicy_1.CloudWatchBasicLoggingPolicy.get(stack));
        role.attachInlinePolicy(SqsProduceMessagePolicy_1.SqsProduceMessagePolicy.get(stack));
        return role;
    }
}
exports.ApiGatewayRole = ApiGatewayRole;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXBpR2F0ZXdheVJvbGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJBcGlHYXRld2F5Um9sZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBLDhDQUF3RDtBQUN4RCxrREFBNkM7QUFDN0MsOEVBQXlFO0FBQ3pFLGlHQUE0RjtBQUM1Rix1R0FBa0c7QUFDbEcscUZBQWdGO0FBQ2hGLDJEQUFzRDtBQUN0RCwrREFBNEQ7QUFFNUQsTUFBYSxjQUFjO0lBQ3ZCLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBWTtRQUN0QixNQUFNLElBQUksR0FBRyxJQUFJLGNBQUksQ0FBQyxLQUFLLEVBQUUscUJBQVMsQ0FBQyxXQUFXLEVBQUU7WUFDaEQsU0FBUyxFQUFFLElBQUksMEJBQWdCLENBQUMscUNBQWlCLENBQUMsTUFBTSxDQUFDO1lBQ3pELFFBQVEsRUFBRSxpQ0FBZ0IsQ0FBQyxLQUFLLENBQUMscUJBQVMsQ0FBQyxXQUFXLENBQUM7U0FDMUQsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLGtCQUFrQixDQUFDLHVDQUFrQixDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQ3ZELElBQUksQ0FBQyxrQkFBa0IsQ0FBQyx5REFBMkIsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUNoRSxJQUFJLENBQUMsa0JBQWtCLENBQUMsMkRBQTRCLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFDakUsSUFBSSxDQUFDLGtCQUFrQixDQUFDLGlEQUF1QixDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBRTVELE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7Q0FDSjtBQWRELHdDQWNDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtTdGFja30gZnJvbSBcIkBhd3MtY2RrL2Nka1wiO1xuaW1wb3J0IHtSb2xlLCBTZXJ2aWNlUHJpbmNpcGFsfSBmcm9tIFwiQGF3cy1jZGsvYXdzLWlhbVwiO1xuaW1wb3J0IHtSZXNvdXJjZXN9IGZyb20gXCIuLi9tb2RlbC9SZXNvdXJjZXNcIjtcbmltcG9ydCB7TGFtYmRhSW52b2tlUG9saWN5fSBmcm9tIFwiLi4vcG9saWNpZXMvbGFtYmRhL0xhbWJkYUludm9rZVBvbGljeVwiO1xuaW1wb3J0IHtLaW5lc2lzUHJvZHVjZU1lc3NhZ2VQb2xpY3l9IGZyb20gXCIuLi9wb2xpY2llcy9raW5lc2lzL0tpbmVzaXNQcm9kdWNlTWVzc2FnZVBvbGljeVwiO1xuaW1wb3J0IHtDbG91ZFdhdGNoQmFzaWNMb2dnaW5nUG9saWN5fSBmcm9tIFwiLi4vcG9saWNpZXMvY2xvdWQtd2F0Y2gvQ2xvdWRXYXRjaEJhc2ljTG9nZ2luZ1BvbGljeVwiO1xuaW1wb3J0IHtTcXNQcm9kdWNlTWVzc2FnZVBvbGljeX0gZnJvbSBcIi4uL3BvbGljaWVzL3Nxcy9TcXNQcm9kdWNlTWVzc2FnZVBvbGljeVwiO1xuaW1wb3J0IHtTZXJ2aWNlUHJpbmNpcGFsc30gZnJvbSBcIi4vU2VydmljZVByaW5jaXBhbHNcIjtcbmltcG9ydCB7TmFtaW5nQ29udmVudGlvbn0gZnJvbSBcIkBtb25zYW50b2l0L3ZjaXMtY2RrLXV0aWxzXCI7XG5cbmV4cG9ydCBjbGFzcyBBcGlHYXRld2F5Um9sZSB7XG4gICAgc3RhdGljIGNyZWF0ZShzdGFjazogU3RhY2spOiBSb2xlIHtcbiAgICAgICAgY29uc3Qgcm9sZSA9IG5ldyBSb2xlKHN0YWNrLCBSZXNvdXJjZXMuQVBJX0dXX1JPTEUsIHtcbiAgICAgICAgICAgIGFzc3VtZWRCeTogbmV3IFNlcnZpY2VQcmluY2lwYWwoU2VydmljZVByaW5jaXBhbHMuQVBJX0dXKSxcbiAgICAgICAgICAgIHJvbGVOYW1lOiBOYW1pbmdDb252ZW50aW9uLmFwcGx5KFJlc291cmNlcy5BUElfR1dfUk9MRSlcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcm9sZS5hdHRhY2hJbmxpbmVQb2xpY3koTGFtYmRhSW52b2tlUG9saWN5LmdldChzdGFjaykpO1xuICAgICAgICByb2xlLmF0dGFjaElubGluZVBvbGljeShLaW5lc2lzUHJvZHVjZU1lc3NhZ2VQb2xpY3kuZ2V0KHN0YWNrKSk7XG4gICAgICAgIHJvbGUuYXR0YWNoSW5saW5lUG9saWN5KENsb3VkV2F0Y2hCYXNpY0xvZ2dpbmdQb2xpY3kuZ2V0KHN0YWNrKSk7XG4gICAgICAgIHJvbGUuYXR0YWNoSW5saW5lUG9saWN5KFNxc1Byb2R1Y2VNZXNzYWdlUG9saWN5LmdldChzdGFjaykpO1xuXG4gICAgICAgIHJldHVybiByb2xlO1xuICAgIH1cbn1cblxuIl19